<?xml version="1.0" encoding="utf-8"?>
<problem
    package="problems.os"
    id="vga-teletype"
    type="standard">
  <statement language="ru_RU">
    <description>
        <p>Напишите драйвер текстового вывода на экран, который:</p>
        <ul><li>прокручивает экран при его заполнении;</li>
            <li>поддерживает правильную позицию курсора на экране.</li></ul>

        <p>Вы должны определить две функции:</p>

        <pre>void vga_set_cursor(unsigned offset);
void vga_putc(char c);</pre>

        <p>Позиция курсора <code>offset</code> (16-битное целое) хранится в 8-битных
        внутренних регистрах видеоадаптера VGA,
        имеющих номера 0xf (младший байт <code>offset</code>) и 0xe (старший байт).</p>

        <p>Работать с регистрами VGA можно через два порта ввода-вывода: 0x3d4 и 0x3d5.
        Если в порт 0x3d4 записать номер регистра VGA, то через порт 0x3d5 можно читать и
        записывать содержимое этого регистра. См. функцию
        <a href="https://github.com/hse-cs-ami/yabloko-public/blob/vga-symbols/drivers/vga.c#L18"
        >vga_get_cursor</a>: она последовательно читает содержимое обоих регистров
        и собирает из них смещение курсора. Функцию <code>vga_set_cursor</code>
        напишите по аналогии.</p>

    <p>Вывод символов можно производить с помощью функции vga_set_char.</p>

    <p>Вывод символа перевода строки (код 0xa) должен приводить к тому, что курсор
        помещается в столбце 0 на строку ниже.</p>

    <p>Текст должен автоматически переноситься между строками, а при заполнении всего экрана
       должна происходить прокрутка. Ниже приведены примеры того, как должно измениться
       состояние экрана при выводе строки "hello" (5 последовательных вызовов <code>vga_putc</code>)
           при различных позициях курсора (курсор обозначен знаком <code>_</code>):</p>
<pre>
┌─────────────┐      ┌─────────────┐
│xxx_         │      │xxxhello_    │
│             │      │             │
│             │ ───► │             │
│             │      │             │
│             │      │             │
└─────────────┘      └─────────────┘


┌─────────────┐      ┌─────────────┐
│xxxyyyyyyy_  │      │xxxyyyyyyyhel│
│             │      │lo_          │
│             │ ───► │             │
│             │      │             │
│             │      │             │
└─────────────┘      └─────────────┘


┌─────────────┐      ┌─────────────┐
│xxxyyyyyyyzzz│      │xxxyyyyyyyzzz│
│zzzzzzzz_    │      │zzzzzzzzhello│
│             │ ───► │_            │
│             │      │             │
│             │      │             │
└─────────────┘      └─────────────┘


┌─────────────┐      ┌─────────────┐
│xxxyyyyyyyzzz│      │zzzzzzzzttttt│
│zzzzzzzzttttt│      │.............│
│.............│ ───► │.............│
│.............│      │..........hel│
│.........._  │      │lo_          │
└─────────────┘      └─────────────┘
</pre>

<p>Не используйте вывод на последовательный порт (функции <code>uartputc</code>, <code>printk</code>).</p>

    <p><a href="https://github.com/hse-cs-ami/yabloko-public/tree/vga-teletype">Необходимый исходный код «Яблока»</a></p>

    </description>
  </statement>
</problem>
